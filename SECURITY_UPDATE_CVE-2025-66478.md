# Security Update: CVE-2025-66478 and Related CVEs

**Date:** December 2025  
**Severity:** Critical (CVSS 10.0)

## Summary

This document tracks the security updates applied to address critical vulnerabilities in Next.js React Server Components (RSC) protocol.

## Vulnerabilities Addressed

### 1. CVE-2025-66478 (Critical)
- **Severity:** CVSS 10.0
- **Type:** Remote Code Execution (RCE)
- **Description:** Vulnerable RSC protocol allowed untrusted inputs to influence server-side execution behavior, enabling remote code execution via crafted RSC payloads.

### 2. CVE-2025-55184 (High)
- **Type:** Denial of Service (DoS)
- **Description:** DoS via malicious HTTP request causing server to hang and consume CPU.

### 3. CVE-2025-55183 (Medium)
- **Type:** Information Disclosure
- **Description:** Compiled Server Action source code can be exposed via malicious request.

### 4. CVE-2025-67779 (High)
- **Type:** Denial of Service (DoS)
- **Description:** Incomplete fix for CVE-2025-55184 DoS via malicious RSC payload causing infinite loop.

## Actions Taken

### Package Updates
- **Next.js:** Upgraded from `16.0.0` ‚Üí `16.0.10`
- **eslint-config-next:** Updated to `16.0.10` to match Next.js version

### Verification
- Ran `npx fix-react2shell-next --fix` to verify and apply patches
- All vulnerabilities confirmed patched

## Required Actions

### ‚úÖ Immediate (Completed)
- [x] Upgrade Next.js to patched version (16.0.10)
- [x] Update eslint-config-next to match
- [x] Verify patches applied correctly

### üîê Critical: Secret Rotation (Required)

**If your application was online and unpatched as of December 4th, 2025 at 1:00 PM PT, you MUST rotate all secrets immediately.**

#### Secrets to Rotate (Priority Order)
1. **Database credentials** (if exposed)
2. **API keys** (third-party services)
3. **JWT signing secrets** (`NEXTAUTH_SECRET`, `JWT_SECRET`, etc.)
4. **OAuth client secrets**
5. **Encryption keys**
6. **Session secrets**
7. **Environment variables** containing sensitive data

#### Rotation Steps
1. **Identify all secrets** used by the application
2. **Generate new secrets** for each
3. **Update environment variables** in:
   - Local `.env` files
   - CI/CD pipelines
   - Production deployment environments
   - Development environments
4. **Deploy updated application** with new secrets
5. **Invalidate old sessions/tokens** if applicable
6. **Monitor for unauthorized access** after rotation

#### Environment Variables in This Project
Based on the codebase, ensure you rotate:
- `UPSTREAM_API_BASE_URL` related credentials (if any)
- `NEXT_PUBLIC_API_BASE_URL` related credentials (if any)
- Any authentication tokens/secrets
- Database connection strings (if applicable)
- Third-party API keys

### üìã Post-Deployment Checklist
- [ ] Test application functionality after update
- [ ] Verify all API endpoints working correctly
- [ ] Check authentication flows
- [ ] Monitor error logs for issues
- [ ] Rotate all secrets (if application was exposed)
- [ ] Update deployment documentation
- [ ] Commit and tag the security update

## Testing Recommendations

After deployment, thoroughly test:
1. **Authentication flows** (login, OTP verification, session management)
2. **API routes** (all BFF endpoints)
3. **Server Components** (RSC functionality)
4. **Server Actions** (if used)
5. **Protected routes** (middleware, authorization)

## References

- [Next.js Security Advisory: CVE-2025-66478](https://nextjs.org/blog/CVE-2025-66478)
- [React Security Advisory: CVE-2025-55182](https://www.cve.org/CVERecord?id=CVE-2025-55182)
- [GitHub Security Advisory: GHSA-9qr9-h5gf-34mp](https://github.com/vercel/next.js/security/advisories/GHSA-9qr9-h5gf-34mp)
- [Fix Tool Repository](https://github.com/vercel-labs/fix-react2shell-next)

## Notes

- The vulnerability only affects applications using **App Router** with **React Server Components**
- **Pages Router** applications are not affected
- **Edge Runtime** is not affected
- Next.js 13.x and 14.x stable are not affected

---

**Status:** ‚úÖ Patched and verified  
**Next Action:** Rotate secrets if application was exposed before patching

